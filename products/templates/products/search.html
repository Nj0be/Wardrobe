{% extends "products/base.html" %}

{% block content %}
<!-- Categories Menu -->
<ul>
  {% for category in categories %}
    <li>
     {% if category %}
        <a href="{% url 'search_category' category.id %}">{% if selected_category.parent == category %}Torna indietro - {% endif %}{{ category.name }}</a>
     {% else %}
        <a href="{% url 'search' %}">Torna indietro - Root</a>
     {% endif %}
    </li>
  {% endfor %}
</ul>

<!-- Colors and Sizes Filter Section -->
<form style="border: 1px solid black" action="{% if selected_category %}{% url 'search_category' selected_category.id %}{% else %}{% url 'search' %}{% endif %}" id="filtersForm" method="get">
  <input type="text" name="search_terms" id="search_terms" placeholder="Cerca il tuo prodotto"
         {% if search_terms %}value="{{ search_terms }}"{% endif %}>
  <input type="submit" value="Search">

  <div class="filters">
    <p>Marche</p>
    {% for brand in brands %}
      <input type="checkbox" name="brand" id="brand_{{ forloop.counter }}" value="{{ brand.id }}"
          {% if brand in selected_brands %} checked {% endif %}
             onchange="document.getElementById('filtersForm').submit();">
      <label for="brand_{{ forloop.counter }}">{{ brand.name }}</label><br>
    {% endfor %}
  </div>

  <div class="filters">
    <p>Colori</p>
    {% for color in colors %}
      <input type="checkbox" name="color" id="color_{{ forloop.counter }}" value="{{ color.id }}"
          {% if color in selected_colors %} checked {% endif %}
             onchange="document.getElementById('filtersForm').submit();">
      <label style="color: #{{ color.hex }}"
             for="color_{{ forloop.counter }}">{{ color.name }}</label><br>
    {% endfor %}
  </div>

  <div class="filters">
    <p>Taglie</p>
    {% for size in sizes %}
      <input type="checkbox" name="size" id="size_{{ forloop.counter }}" value="{{ size.id }}"
          {% if size in selected_sizes %} checked {% endif %}
             onchange="document.getElementById('filtersForm').submit();">
      <label for="size_{{ forloop.counter }}">{{ size.name }}</label><br>
    {% endfor %}
  </div>
</form>

<!-- Start Content # mostra i prodotti -->
{% if products %}
  <h1>Products:</h1>
  <ul>
    {% for product in products %}
      <li><a href="{% url 'product' product.id %}">{{ product.name }}</a></li>
    {% endfor %}
  </ul>
{% else %}
  <p>Nessun prodotto disponibile</p>
{% endif %}

{% endblock %}
